# CrowdSieve Configuration

# =============================================================================
# Proxy Settings
# =============================================================================
PROXY_PORT=8080
CAPI_URL=https://api.crowdsec.net
PROXY_TIMEOUT_MS=30000
FORWARD_ENABLED=true

# =============================================================================
# Storage
# =============================================================================

# Storage type: sqlite (default) or postgres
STORAGE_TYPE=sqlite

# SQLite settings (used when STORAGE_TYPE=sqlite)
DATABASE_PATH=./data/crowdsieve.db

# PostgreSQL settings (used when STORAGE_TYPE=postgres)
# POSTGRES_HOST=localhost
# POSTGRES_PORT=5432
# POSTGRES_DATABASE=crowdsieve
# POSTGRES_USER=crowdsieve
# POSTGRES_PASSWORD=your-secure-password
# POSTGRES_SSL=false
# POSTGRES_POOL_SIZE=10

# Data retention
RETENTION_DAYS=30

# =============================================================================
# Logging
# =============================================================================
LOG_LEVEL=info
LOG_FORMAT=json

# =============================================================================
# GeoIP
# =============================================================================
GEOIP_DB_PATH=./data/GeoLite2-City.mmdb

# =============================================================================
# Security
# =============================================================================

# CORS origin (leave empty to reject all cross-origin requests; set to a specific origin to allow it)
# Example: http://localhost:3000 or https://dashboard.example.com
CORS_ORIGIN=

# Dashboard API authentication key (leave empty for development/no auth)
# Generate with: openssl rand -hex 32
DASHBOARD_API_KEY=

# Rate limiting (requests per time window)
RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW=60000

# =============================================================================
# Client Validation
# =============================================================================

# Enable validation of CrowdSec clients against CAPI (default: false)
CLIENT_VALIDATION_ENABLED=false

# Cache TTL for validated clients in seconds (default: 604800 = 1 week)
CLIENT_VALIDATION_CACHE_TTL=604800

# Cache TTL when CAPI is unreachable in seconds (default: 3600 = 1 hour)
CLIENT_VALIDATION_CACHE_TTL_ERROR=3600

# Timeout for CAPI validation requests in milliseconds (default: 5000)
CLIENT_VALIDATION_TIMEOUT_MS=5000

# Maximum number of entries in memory LRU cache (default: 1000)
CLIENT_VALIDATION_MAX_MEMORY_ENTRIES=1000

# Fail-closed mode: reject requests when CAPI is unavailable (default: false)
# Set to true for security-sensitive deployments
CLIENT_VALIDATION_FAIL_CLOSED=false
